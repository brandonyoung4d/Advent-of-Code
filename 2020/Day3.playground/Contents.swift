import Foundation

class Map {
    let input: String =
        """
        .....#.##......#..##..........#
        ##.#.##..#............##....#..
        ......###...#..............#.##
        .....#..##.#..#......#.#.#..#..
        ..#.......###..#..........#.#..
        ..#..#.##.......##.....#....#..
        .##....##....##.###.....###..#.
        ..##....#...##..#....#.#.#.....
        .....##..###.##...............#
        #.....#..#....#.##...####..#...
        #......#.#....#..#.##....#..#.#
        ##.#...#.#............#......#.
        .#####.......#..#.#....#......#
        ..#.#....#.#.##...#.##...##....
        .....#.#...#..####.##..#.......
        #....#...##.#.#.##.#..##.....#.
        ##.##...#....#...#......#..##..
        ....##...#..#.#...#.#.#.....##.
        ..#....##......##....#.#....#..
        #..#....#....###..#.##....#.#.#
        ..#.#####..##....#....#.....##.
        .#...##.......#...#....#.#...##
        #.#.#.##.......#.....#.#.#....#
        .#.#.....#.......#.......##....
        .#......#....#....#.......##...
        #......#.....#......#..#..#....
        #.#...#...#....##....#.#...#..#
        ....#.....##...#...#..#.#......
        ..#......#..........#...#.#....
        ..#..#......####..##...###.....
        .#.....#...##...#.##........###
        #.#....#..#....#..#.....#.#..#.
        ...##.##.#.#.##...#.....#......
        ##....#.#.#...####.#.#.#.#.....
        .##.........#..#..###..........
        ..##.###.#..#..#....##.....#...
        ##........#..###....#.#..#..#..
        ....#.#.......##..#.#.#.#......
        ....##.....#.........##.......#
        ..#........##.#.........###..##
        ....#..................##..#...
        #...#.#..###..#.....#..#..#...#
        ..#..#.##..#..#.......#.......#
        .....#..##..#....##...........#
        ..##...#........#...#.#.......#
        .........#.#..#.#..#.##.#.###..
        ....#...#..#..#......##....#.#.
        ..#..#.#....#....#..#.####..##.
        ##....#.....#......##.###.#..#.
        #..#..##..###......#.#.#.#...#.
        .......#..##..##...#...#..#....
        ..#.###.#...#....#.##.#.....##.
        .#.#.......##...##...##....#...
        #...#.#.#...#.####..#..##......
        ###..#.##..#..........#...#....
        ##.#.........#..##......####...
        ..##.#..#....#.##..............
        ...#....#.......###............
        ...#.....##....#.#.#.#.......##
        ###.###...#...#...###.##...##..
        #.#....#.##..#.....#.....##.#..
        ...#....#....#.........#....#.#
        ##.#....#........#..#..##.#....
        .#.#..#.......#...##.......#...
        .##...##........#....#.#..#....
        ....#..#.##.###.....#.#........
        .#.#...#.#..#.....#.........#..
        .......#.#.#..##....#.........#
        .##...#....#..#...#........#..#
        ....#....#..#.#..#.#.#....##.##
        ..##....#.....##..#.#...#...#..
        #.##.........#.....#.......#.##
        ...#...##.#.#..........#......#
        ###...#.....#..#.......#####..#
        #.####...##.#.#..#...#.........
        .##.....#.....##..#...##.##....
        .........###...#......##....###
        .#....##...###.#..#...##..#.#.#
        .......#.......#.#...##.#......
        .....#.#........#..##.....##...
        ....#.#.........##.#...##..#.#.
        #..#..#.##..#.##.##.....##.###.
        ..##.........###...#....#....#.
        .###...#..#.##...........#.....
        #..##..........#..........#....
        .....#.#....#..##..#...#.#....#
        ..#.....#.#....#...##.##.......
        ##.....##........#....#..##....
        .#..#.#.........#..#..#........
        .............##....#....#..#...
        ....##....#..#.#.##....###.##.#
        .###..#.....#..#..##..#..##..#.
        ...#..###.......#.#....#..###..
        #.#..#.....#...#......#........
        #..#..............###.#......#.
        ..#....##.#....#.##.#.#...#....
        .........##..#...#.#.......#...
        ........#...#.#....#.....##..#.
        ...#.##..#..#..###..#..#......#
        .....####......#...#....#...#.#
        ...###.#.#......#....#.......#.
        #...##.#....#....##....##.###..
        .......##...##.....#.##.#..#..#
        .....#.#............##...#.####
        .##..#.#.#.#..#.#.#.....#.##...
        .#..####...#.#....#.....#..#...
        ....##..#.#...#..#....#.#......
        ...#......###..#..###..#.....#.
        .#.#.#..##....#...##..#.....#..
        ###....#....#...##.....#...#...
        #.##....#......#...###.........
        .#..#.#...#..#....#....#....#..
        ...............##...####..#..#.
        #.#...........####..#...##.....
        ##.#....#........#......#...##.
        ......#...#...#....#....#.....#
        #......#.............#....###..
        .#...#...##.....#...##.##..#...
        ..#.#......#.#........#........
        .......#..#.#...##..#.#.#......
        ..##...#.##........#....#.#...#
        .....#..#..#........#.#......##
        ....#.#...##............##....#
        .#.#....#.#.#...#...#.##.....#.
        #.#.##...#....#.#.#..#.##..#.#.
        .........####..#...#...#.......
        #..#..####......#..##..#...#...
        .........##..................#.
        .....##.#..##.#.#...#......##..
        ...#....#....#.#.....#...#..#.#
        #...##.#...##...........#..#...
        #..........#.#..#..#.##..#..#.#
        .#...#.##...#.#.#..#.......##..
        .........#...........#..#..#...
        .##...##....#.#......#........#
        #.#...........#....#.......#...
        ##.#.#.......#...###......##..#
        ...###..#.##..##.#.#.......#...
        .#...#..##.#...#........#.....#
        ...#.......#..#..........#.#...
        ..#.#.#.#.....#.#.......#..#..#
        #.##.....#..##...#..###.#....#.
        .......#...........#...#....###
        .......#..#...#.............#..
        #.....###.......#...#........#.
        .#..#..#..#...........#........
        ....#.#...#.#.##.#.#....#.##..#
        .......#..##...##...#...#......
        ...#.....##.###...#.#...##....#
        #..#....#...##......#....##....
        #.#.......#....#.###.##..#..#..
        ..##...........#...#....#......
        .#........#.....#..#..#...#..##
        .....#.#.#..#.......#....#.....
        #..#.#......#......##....#.....
        ##.....................##......
        .##........###..#.........#...#
        ........#.........#..#.........
        .#.##....#.....#...#.........##
        ....##......#.........#........
        ...#.#..#...##.##.#.#..####....
        ..##...........##.#.#....#.....
        .#.....#.#...#..#.......#....#.
        ....#...#......##...#...##.#..#
        ....#..##....#..#.........##.#.
        ..##...##.##....#....##.###...#
        ..#....##..##.#.#.#...#......#.
        ##...#.........#...........#...
        .##....##.#.....#...#.......#..
        ..........##.###.##....###....#
        ..........#..##..#....#.#.##.##
        ........##.#...#.#.#.#...###.#.
        .#......#.#.#...###.#.#.#......
        .........#......#......#...#..#
        ......#.....#.##....##.#####..#
        ..#..##...###.#..........#.#.#.
        .#..#....###.#...#..#....#...##
        ...................#..........#
        ....###.....#...##......#.....#
        #.....#..##.....#.#..........#.
        ..#.......##.#....#..#.##.#...#
        ........##.#..###..#......##...
        #...........##.#...###..#....#.
        ....#...........#.....#.#...#..
        .##..#.#...#...#.##...#..#.....
        #........#.#.#.#.#.#...........
        #..#.....#..#..#.##....#....#.#
        ..#............##....#.#.##...#
        .....###.#....#.#......#.###...
        ...#.....#.#.................#.
        ..#...##..#.#...#...#...#.....#
        .##.#........#..#....##..#..##.
        .#..........#...#.#..#..#.#....
        #.......##.........#.##..#.####
        .#..............#.......##.....
        #......#.##..........#..#......
        ..##...#...#.#...#............#
        .##.##..##..##........##.....#.
        .....#..#.....##...............
        .#..#...##...#...#.....#.......
        #......#...#.......#..##.###.##
        ###..##......##......###....#..
        ....#..........#...#.##.#.....#
        .........#....#..#..#.#..##....
        .....#.....#...........#......#
        .#.......#...#....##...#.##...#
        ..##.#..............#..#...#.#.
        .#..####.#.........#....#....#.
        ..###.#...#..#......#.......###
        .#.#..##...###...#...#.#...#.#.
        ...#..##..###.#..#.....#.##....
        #...###.#...##.....####.....#..
        .#.##...#..#.#..##.....#.......
        ...#.##.....##.....#....#......
        .#...##.....#..###..#..........
        ..........#...#.....#....##.#..
        .......#...#...#...#........#..
        #....##..#...#..##.#.#.....#...
        .#.#..............#..#....#....
        .####.#.#.###......#...#.#....#
        .#...#...##.#...............#.#
        ...#.......##...#...#....##....
        #..........###.##..........##.#
        .......#...#....#.#..#.#....#..
        ....#.##.#...###..#..##.##.....
        ..#.#.#......#.#.......###.....
        #..................#.##....#...
        #.....#..#.#.#..#...#.........#
        ..#..#...#.#.##........#.......
        #..#.#..#..........###...#.#...
        .......#.##....#........##.#...
        .####.#.#...#.#...##.##.....###
        ........#.#...#.#..##...##.....
        ....##.##......#.##.........#..
        .#..#...#.#...........#........
        .......#..........#....#...#...
        ..###.#.###..#..#.....#..##....
        .#..........#.......##...#.....
        .#.....#...#........#...#.##..#
        .#..#.......#..#.......#.#.#...
        ....#..##.#...##...#.#....#....
        .....#.........#..#..#....#....
        ..#.#..##....#..#..##.#.#.....#
        ........#.#...###....#.#.#.....
        .#.....#.......#..###.#........
        .......#...#.#...#...##........
        ##.............#.#.....#.#..#..
        .#....#.......#.#.......#..##..
        #.....#........#..##..##.......
        ...........#.........###......#
        ....#.##...#.#...#...#....#..##
        ......#..##......#......#.##.#.
        ......##....####...###...#.....
        #....#..........#.#.##.....#..#
        ....#.#...........#.#.#.#.#...#
        ....####.....##...#..##..#...#.
        #....#.###..###.....#..###.....
        ..##.........#......#...##.#...
        ..#.....#.#...#.##.#...#..###.#
        ..#.##..##........#.......#.###
        .....#..........#.....#....#...
        .......##..##..###.......#####.
        ..###......#.#....###....##...#
        #..##.....#..###...#.....##.##.
        #..#..##.##.###.####.##.#......
        .#.#......#.##......#..#......#
        ..###.....#.#......#.#.####....
        #..............#..#.#...#.###..
        ...#..#.##..........##.#...#.##
        .#.#.#.........#....#.#..#.....
        ..#.##..#...#..#...#......#....
        .......#...#.##.#.#..#...##..#.
        ..........#.####...#........#.#
        ....#...#....##.#.........#.#..
        ##.#..#.......###....#..#..#.#.
        ..##.....#..#.#.#.####......#..
        .#.....#..........#..#..#.#....
        ......#.#.......#.#...#..#..#..
        ...#...............#....#...#..
        ##.......#.........#.......#...
        ...#.......###...#.#...#.......
        #...###....#....##....#....#...
        ...#....##..#.#.............##.
        .....#.#.#..#......#...#.#..#..
        .##....#..##..#####..##.....##.
        ....##.#.#..#.....#.#...#......
        ...#.....##.#.#..##..#.#.......
        .......#..#..#..........#......
        .......#...#..#.........#.##...
        ..#..#..#...##..#.#....#......#
        ..#....#...#.#......#........#.
        .#...#..#...#.#..........#.....
        #..#...####..#......##.##.#.#..
        .#...#.#...#.#.....#..##.#.....
        ..#.##.#......#.........##...#.
        ###..............#.............
        ...#...###....#..#.............
        .##....#......#..#.....#..#..#.
        .#..........#.....##...#..#....
        ....##..#.#......###.##......#.
        .#..##.#.##.#...##.#......###.#
        #..###.#...###..#........#.#...
        #..#.#.#..#...###.##.##..#..#..
        #.#..#....#.........##......#..
        ....###.....###....#...........
        ....#..##.##....##..#.....#....
        .#.....#....####...#..##.#..###
        .........##..#......#.#...##...
        .##.......#.....#.###.#..#.#..#
        .....#.#...###.....#......####.
        ##.#...#......#.#.#..#.####...#
        .#.##.....#..#..#.............#
        .#..###..#..#......#..##......#
        .......#.#........##.....#.#...
        #....#...#..###..#.#.....#.##..
        .##.....#.#....###..#.....##...
        ...##....#....#...#....#.#.#...
        #####..#...........###....#...#
        .#.......##.##.....#....#......
        .#..#.#...#..#......#...#..#.#.
        ....#.....##...#####..#...#...#
        ###.##...#.#............#....#.
        .....#...#........##.........#.
        """
    let width: Int
    let height: Int
    let grid: [[Character]]
    
    init() {
        let rows = input.components(separatedBy: CharacterSet.newlines)
        
        self.width = rows.first!.count
        self.height = rows.count
        
        var grid = [[Character]](repeating: [Character](repeating: " ", count: height), count: width)
        var x = 0
        var y = 0
        
        for i in input {
            if i == "\n" { continue }
            
            grid[x][y] = i
            x += 1
            
            if x == width {
                x = 0
                y += 1
            }
        }
        self.grid = grid
    }
    
    func isTree(x: Int, y: Int) -> Bool {
        if y >= height || y < 0 {
            print("Out of bounds Y")
            return false
        }
        
        let wrappedX = x % width
        return grid[wrappedX][y] == "#"
    }
}

let map = Map()
let slopes =  [(x: 1, y: 1), (x: 3, y: 1), (x: 5, y: 1), (x: 7, y: 1), (x: 1, y: 2)]
var treesHitTotal = 0
var firstSlope = true

for slope in slopes {
    let slopeX = slope.x
    let slopeY = slope.y
    
    var y = 0
    var x = 0
    var treesHit = 0
    while y < map.height {
        if map.isTree(x: x, y: y) { treesHit += 1 }
        
        x += slopeX
        y += slopeY
    }
    
    print(treesHit)
    if firstSlope {
        treesHitTotal = treesHit
        firstSlope = false
    } else {
        treesHitTotal *= treesHit
    }
}

print("Trees hit total = \(treesHitTotal)")
